<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <title>Anesthesia Toolkit</title>
  <meta name="description" content="Local anesthesia practice toolkit: dosing calculators, pre-op guidance, checklists, and references." />

  <!-- Prevent theme flash: apply saved theme before first paint -->
  <script>
    (function () {
      const t = localStorage.getItem('theme'); // "dark" | "light" | "system" | null
      if (t === 'dark' || t === 'light') {
        document.documentElement.setAttribute('data-theme', t);
        document.documentElement.style.colorScheme = t; // native controls match
      } else {
        // System theme: no explicit override; allow media query + browser default
        document.documentElement.removeAttribute('data-theme');
        document.documentElement.style.colorScheme = '';
      }
    })();
  </script>

  <style>
    /* =============== THEME TOKENS =============== */
    /* Default (Dark) theme */
    :root{
      --bg: #0b1220;
      --surface: rgba(255,255,255,.06);
      --surface-2: rgba(255,255,255,.09);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.72);
      --border: rgba(255,255,255,.12);
      --shadow: 0 12px 30px rgba(0,0,0,.25);
      --accent: #7c5cff;
      --accent-2:#16c2a1;
      --warn:#ffcc66;
      --radius: 18px;
      --radius-sm: 14px;
      --max: 1100px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }

    /* Explicit Light theme when user selects it */
    :root[data-theme="light"]{
      --bg:#f6f7fb;
      --surface: rgba(17,24,39,.05);
      --surface-2: rgba(17,24,39,.08);
      --text: rgba(17,24,39,.92);
      --muted: rgba(17,24,39,.7);
      --border: rgba(17,24,39,.12);
      --shadow: 0 12px 30px rgba(17,24,39,.10);
      --accent:#5b5cff;
      --accent-2:#0fb49a;
      --warn:#c07a00;
    }

    /* Follow system preference only when user hasn't chosen a theme */
    @media (prefers-color-scheme: light){
      :root:not([data-theme]){
        --bg:#f6f7fb;
        --surface: rgba(17,24,39,.05);
        --surface-2: rgba(17,24,39,.08);
        --text: rgba(17,24,39,.92);
        --muted: rgba(17,24,39,.7);
        --border: rgba(17,24,39,.12);
        --shadow: 0 12px 30px rgba(17,24,39,.10);
        --accent:#5b5cff;
        --accent-2:#0fb49a;
        --warn:#c07a00;
      }
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: var(--font);
      color: var(--text);
      background:
        radial-gradient(900px 400px at 20% -10%, rgba(124,92,255,.35), transparent 60%),
        radial-gradient(900px 400px at 90% 0%, rgba(22,194,161,.28), transparent 55%),
        radial-gradient(900px 700px at 50% 120%, rgba(255,204,102,.15), transparent 60%),
        var(--bg);
      line-height: 1.35;
    }

    a{color:inherit; text-decoration:none}
    .container{max-width:var(--max); margin:0 auto; padding:28px 18px 44px;}

    /* Header */
    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:14px; padding:14px 16px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }
    .brand{
      display:flex; align-items:center; gap:10px; min-width: 200px;
    }
    .logo{
      width:38px; height:38px; border-radius: 14px;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      box-shadow: 0 10px 18px rgba(0,0,0,.18);
      display:grid; place-items:center;
      flex:0 0 auto;
    }
    .logo svg{opacity:.95}
    .brand h1{font-size:15px; margin:0; letter-spacing:.2px}
    .brand p{margin:2px 0 0; font-size:12px; color:var(--muted)}

    .actions{
      display:flex; align-items:center; gap:10px; flex-wrap:wrap;
      justify-content:flex-end;
    }

    .pill{
      display:flex; align-items:center; gap:8px;
      padding:9px 12px;
      border: 1px solid var(--border);
      border-radius: 999px;
      background: rgba(255,255,255,.02);
    }
    .pill input{
      border:0; outline:0; background:transparent; color:var(--text);
      width:min(340px, 52vw);
      font-size:14px;
    }
    .pill input::placeholder{color:var(--muted)}
    .kbd{
      font-size:12px; color:var(--muted);
      padding:2px 8px; border-radius:999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.02);
    }

    button.iconbtn{
      border: 1px solid var(--border);
      background: rgba(255,255,255,.02);
      color: var(--text);
      border-radius: 999px;
      padding: 9px 12px;
      cursor:pointer;
      transition: transform .06s ease, background .15s ease, border-color .15s ease;
      display:flex;
      align-items:center;
      gap:8px;
      position:relative;
      white-space:nowrap;
    }
    button.iconbtn:hover{background: rgba(255,255,255,.06)}
    button.iconbtn:active{transform: translateY(1px)}

    /* Optional polish: subtle mode badge that doesn't clutter */
    button.iconbtn[data-mode]::after{
      content: attr(data-mode);
      margin-left: 2px;
      font-size: 12px;
      line-height: 1;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.02);
      color: var(--muted);
    }

    /* Hero */
    .hero{
      margin-top:18px;
      padding:22px 20px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
    }
    .hero h2{
      margin:0;
      font-size: 18px;
      letter-spacing:.2px;
    }
    .hero p{
      margin:8px 0 0;
      color: var(--muted);
      max-width: 70ch;
      font-size: 14px;
    }
    .chips{display:flex; flex-wrap:wrap; gap:8px; margin-top:14px}
    .chip{
      font-size: 12px;
      color: var(--muted);
      border: 1px solid var(--border);
      background: rgba(255,255,255,.02);
      padding: 6px 10px;
      border-radius: 999px;
    }

    /* Sections */
    .section{
      margin-top: 18px;
      padding: 18px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: var(--surface);
      box-shadow: var(--shadow);
    }
    .sectionhead{
      display:flex; align-items:baseline; justify-content:space-between; gap:14px;
      margin-bottom: 12px;
    }
    .sectionhead h3{
      margin:0; font-size: 14px; letter-spacing:.3px; text-transform: uppercase;
      color: var(--muted);
    }
    .sectionhead .count{
      font-size: 12px; color: var(--muted);
      border: 1px solid var(--border);
      border-radius: 999px;
      padding: 5px 10px;
      background: rgba(255,255,255,.02);
    }

    /* Cards grid */
    .grid{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 12px;
    }
    .card{
      grid-column: span 6;
      min-height: 120px;
      padding: 14px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      transition: transform .12s ease, border-color .15s ease, background .15s ease;
      position:relative;
      overflow:hidden;
    }
    .card:hover{
      transform: translateY(-2px);
      border-color: rgba(124,92,255,.35);
      background: linear-gradient(180deg, rgba(124,92,255,.12), rgba(255,255,255,.02));
    }
    .card:active{transform: translateY(0px)}
    .card .row{
      display:flex; align-items:flex-start; gap:12px;
    }
    .icon{
      width: 42px; height: 42px; border-radius: 14px;
      background: rgba(255,255,255,.06);
      border: 1px solid var(--border);
      display:grid; place-items:center; flex:0 0 auto;
    }
    .card h4{margin:0; font-size: 15px}
    .card p{margin:6px 0 0; font-size: 13px; color: var(--muted); max-width: 70ch}
    .meta{
      margin-top: 10px;
      display:flex; flex-wrap:wrap; gap:8px;
    }
    .tag{
      font-size: 12px;
      padding: 4px 9px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.02);
      color: var(--muted);
    }
    .tag.accent{border-color: rgba(124,92,255,.35); color: var(--text)}
    .tag.good{border-color: rgba(22,194,161,.35); color: var(--text)}
    .tag.warn{border-color: rgba(255,204,102,.35); color: var(--text)}
    .go{
      position:absolute; right:12px; top:12px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.02);
      border-radius: 999px;
      padding: 6px 9px;
      font-size: 12px;
      color: var(--muted);
    }

    /* Responsive */
    @media (max-width: 820px){
      .card{grid-column: span 12;}
      .brand{min-width:unset}
      .pill input{width: 52vw}
    }

    /* Footer */
    footer{
      margin-top: 18px;
      padding: 14px 4px 0;
      color: var(--muted);
      font-size: 12px;
      display:flex;
      justify-content:space-between;
      gap: 10px;
      flex-wrap:wrap;
    }
    .smalllink{
      color: var(--muted);
      text-decoration: underline;
      text-underline-offset: 3px;
    }

    /* Hidden (for filtering) */
    .hidden{display:none !important;}
  </style>
</head>

<body>
  <div class="container">
    <header class="topbar" role="banner note">
      <div class="brand" aria-label="Site identity">
        <div class="logo" aria-hidden="true">
          <!-- Simple anesthesia-ish icon -->
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
            <path d="M6 14c0-4.5 3.6-8 8-8h3" stroke="white" stroke-width="2" stroke-linecap="round"/>
            <path d="M6 14c0 3.3 2.7 6 6 6h5" stroke="white" stroke-width="2" stroke-linecap="round" opacity=".9"/>
            <path d="M16.5 6.5h3v3" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <circle cx="6" cy="14" r="2" fill="white" opacity=".95"/>
          </svg>
        </div>
        <div>
          <h1>Anesthesia Toolkit</h1>
          <p>Local tools &amp; references for daily practice</p>
        </div>
      </div>

      <div class="actions">
        <div class="pill" role="search">
          <svg width="16" height="16" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M10 18a8 8 0 1 1 0-16 8 8 0 0 1 0 16Z" fill="none" stroke="currentColor" stroke-width="2" opacity=".85"/>
            <path d="M21 21l-4.3-4.3" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity=".85"/>
          </svg>
          <label class="sr-only" for="q" style="position:absolute;left:-9999px;">Search tools</label>
          <input id="q" type="search" placeholder="Search tools (e.g., dosing, fasting, insulin‚Ä¶)" autocomplete="off" />
          <span class="kbd" title="Tip: press / to focus search">/</span>
        </div>

        <button class="iconbtn" id="themeBtn" type="button" title="Theme: System (click to change)">
          <span aria-hidden="true">üñ•Ô∏è</span> Theme
        </button>
      </div>
    </header>

    <section class="hero" aria-label="Overview">
      <h2>Quick access to anesthesia calculators, pre-op guidance, and bedside references</h2>
      <p>
        This index is designed to live alongside your local HTML tools (no internet required).
        Add new pages as you build them ‚Äî they‚Äôll appear as cards under the right category.
      </p>
      <div class="chips" aria-label="Highlights">
        <span class="chip">Offline-friendly</span>
        <span class="chip">Mobile-responsive</span>
        <span class="chip">Fast search</span>
        <span class="chip">Dark-mode</span>
      </div>
    </section>

    <!-- CALCULATORS -->
    <section class="section" aria-label="Calculators">
      <div class="sectionhead">
        <h3>Calculators</h3>
        <div class="count"><span id="countCalculators">0</span> items</div>
      </div>

      <div class="grid" id="gridCalculators">
        <a class="card tool" href="drugdoses.html"
           data-title="Drug Doses"
           data-tags="calculator dosing induction maintenance propofol opioids weight height age sex"
           data-category="Calculators">
          <span class="go">Open ‚Üí</span>
          <div class="row">
            <div class="icon" aria-hidden="true">
              <!-- Calculator icon -->
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M7 3h10a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2Z" stroke="currentColor" stroke-width="2"/>
                <path d="M8 7h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M8 11h2M14 11h2M8 15h2M14 15h2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </div>
            <div>
              <h4>Drug Doses</h4>
              <p>Enter age, sex, weight, and height to estimate anesthesia medication dosing ranges.</p>
              <div class="meta">
                <span class="tag accent">Calculator</span>
                <span class="tag good">Fast</span>
                <span class="tag">Adults / Peds-ready</span>
              </div>
            </div>
          </div>
        </a>
        <a class="card tool" href="venthelper.html"
   data-title="Vent Settings Assistant"
   data-tags="vent ventilation pbw tidal volume rr peep fio2 minute ventilation lung protective ards"
   data-category="Calculators">
  <span class="go">Open ‚Üí</span>
  <div class="row">
    <div class="icon" aria-hidden="true">ü´Å</div>
    <div>
      <h4>Vent Settings Assistant</h4>
      <p>PBW-based tidal volume targets, MV estimate, and quick ventilation planning.</p>
      <div class="meta">
        <span class="tag accent">Calculator</span>
        <span class="tag good">Bedside</span>
        <span class="tag">Adult-focused</span>
      </div>
    </div>
  </div>
</a>

<a class="card tool" href="ponv.html"
   data-title="PONV Risk + Prophylaxis"
   data-tags="ponv nausea vomiting apfel prophylaxis ondansetron dexamethasone droperidol scopolamine tiva"
   data-category="Calculators">
  <span class="go">Open ‚Üí</span>
  <div class="row">
    <div class="icon" aria-hidden="true">ü§¢</div>
    <div>
      <h4>PONV Risk + Prophylaxis</h4>
      <p>Apfel risk score with a prophylaxis builder and copyable plan summary.</p>
      <div class="meta">
        <span class="tag accent">Calculator</span>
        <span class="tag">Apfel</span>
        <span class="tag good">Fast</span>
      </div>
    </div>
  </div>
</a>

<a class="card tool" href="abgcalc.html"
   data-title="ABG Interpreter"
   data-tags="abg acid base winter formula compensation anion gap a-a gradient hypoxemia"
   data-category="Calculators">
  <span class="go">Open ‚Üí</span>
  <div class="row">
    <div class="icon" aria-hidden="true">üß™</div>
    <div>
      <h4>ABG Interpreter</h4>
      <p>Primary disorder, compensation checks, and optional A‚Äìa gradient flagging.</p>
      <div class="meta">
        <span class="tag accent">Calculator</span>
        <span class="tag">Acid‚Äìbase</span>
        <span class="tag warn">Interpret clinically</span>
      </div>
    </div>
  </div>
</a>

<a class="card tool" href="cardiacrisk.html"
   data-title="Cardiac Risk Helper"
   data-tags="cardiac risk rcri mets perioperative evaluation stress test beta blocker echo surgery risk"
   data-category="Calculators">
  <span class="go">Open ‚Üí</span>
  <div class="row">
    <div class="icon" aria-hidden="true">‚ù§Ô∏è</div>
    <div>
      <h4>Cardiac Risk Helper</h4>
      <p>RCRI + functional capacity prompts to support perioperative decision-making.</p>
      <div class="meta">
        <span class="tag accent">Calculator</span>
        <span class="tag">RCRI</span>
        <span class="tag">Adult</span>
      </div>
    </div>
  </div>
</a>

        <!-- Add more calculator cards here -->
      </div>
    </section>

    <!-- GUIDELINES -->
    <section class="section" aria-label="Guidelines">
      <div class="sectionhead">
        <h3>Guidelines</h3>
        <div class="count"><span id="countGuidelines">0</span> items</div>
      </div>

      <div class="grid" id="gridGuidelines">
        <a class="card tool" href="preopguidelines.html"
           data-title="Pre-op Guidelines"
           data-tags="guidelines fasting npo anticoagulants diabetes insulin glp-1 acei arb diuretics beta blocker hold continue"
           data-category="Guidelines">
          <span class="go">Open ‚Üí</span>
          <div class="row">
            <div class="icon" aria-hidden="true">
              <!-- Checklist icon -->
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M9 11l2 2 4-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M4 6h4M4 12h4M4 18h4" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity=".9"/>
                <path d="M10 6h10M10 12h10M10 18h10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </div>
            <div>
              <h4>Pre-op Guidelines</h4>
              <p>Medication management (hold/continue) and fasting guidance for safe preoperative planning.</p>
              <div class="meta">
                <span class="tag accent">Guidelines</span>
                <span class="tag warn">Review updates periodically</span>
                <span class="tag">NPO / Meds</span>
              </div>
            </div>
          </div>
        </a>

        <!-- Add more guideline cards here -->
      </div>
    </section>

    <!-- REFERENCES (optional placeholder) -->
    <section class="section" aria-label="References">
      <div class="sectionhead">
        <h3>References</h3>
        <div class="count"><span id="countReferences">0</span> items</div>
      </div>

      <div class="grid" id="gridReferences">
        <div class="card" style="grid-column: span 12;">
          <div class="row">
            <div class="icon" aria-hidden="true">üìö</div>
            <div>
              <h4>Add your references here</h4>
              <p>
                Link local pages like ‚ÄúAirway Algorithms‚Äù, ‚ÄúVasopressor Cheat Sheet‚Äù, ‚ÄúRegional Blocks‚Äù,
                ‚ÄúPACU Discharge Criteria‚Äù, etc.
              </p>
              <div class="meta">
                <span class="tag">Tip: duplicate a card</span>
                <span class="tag">Set href="yourpage.html"</span>
                <span class="tag">Update data-tags for search</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <footer>
      <div>¬© <span id="year"></span> Anesthesia Toolkit ‚Ä¢ Local-only HTML</div>
      <div>
        <a class="smalllink" href="#" id="clearSearch">Clear search</a>
        <span aria-hidden="true"> ¬∑ </span>
        <a class="smalllink" href="#" id="scrollTop">Back to top</a>
      </div>
    </footer>
  </div>

  <script>
    // =============================
    // THEME: Dark -> Light -> System
    // =============================
    const themeBtn = document.getElementById('themeBtn');

    function getSavedTheme(){
      const t = localStorage.getItem('theme');
      return (t === 'dark' || t === 'light' || t === 'system') ? t : 'system';
    }

    function applyTheme(mode){ // "dark" | "light" | "system"
      if (mode === 'dark' || mode === 'light') {
        document.documentElement.setAttribute('data-theme', mode);
        document.documentElement.style.colorScheme = mode; // native controls match
      } else {
        // system: remove explicit override; CSS media query handles palette
        document.documentElement.removeAttribute('data-theme');
        document.documentElement.style.colorScheme = '';
      }
      localStorage.setItem('theme', mode);
      updateThemeButton(mode);
    }

    function updateThemeButton(mode){
      const icon = (mode === 'dark') ? 'üåô' : (mode === 'light') ? '‚òÄÔ∏è' : 'üñ•Ô∏è';
      const label = (mode === 'dark') ? 'Dark' : (mode === 'light') ? 'Light' : 'System';
      themeBtn.querySelector('span').textContent = icon;

      // Optional polish: compact button + subtle badge
      themeBtn.setAttribute('data-mode', label);
      themeBtn.title = `Theme: ${label} (click to change)`;
      themeBtn.setAttribute('aria-label', `Theme: ${label}. Click to switch theme.`);
    }

    // Initialize button state to what is currently saved (head script already applied it)
    updateThemeButton(getSavedTheme());

    themeBtn?.addEventListener('click', () => {
      const current = getSavedTheme();
      const next = (current === 'dark') ? 'light' : (current === 'light') ? 'system' : 'dark';
      applyTheme(next);
    });

    // If user is in "system" mode and OS preference changes while page is open,
    // our CSS already adapts; we just keep the label/icon consistent.
    if (window.matchMedia) {
      const mq = window.matchMedia('(prefers-color-scheme: dark)');
      mq.addEventListener?.('change', () => {
        if (getSavedTheme() === 'system') updateThemeButton('system');
      });
    }

    // =============================
    // SEARCH / FILTER
    // =============================
    const q = document.getElementById('q');
    const tools = Array.from(document.querySelectorAll('.tool'));

    function normalize(s){ return (s || '').toLowerCase().trim(); }

    function applyFilter(){
      const term = normalize(q.value);

      tools.forEach(card => {
        const hay = normalize(card.dataset.title) + " " +
                    normalize(card.dataset.tags)  + " " +
                    normalize(card.dataset.category);
        const match = term === "" || hay.includes(term);
        card.classList.toggle('hidden', !match);
      });

      updateCounts();
    }

    function updateCounts(){
      const byCategory = {Calculators:0, Guidelines:0, References:0};
      tools.forEach(card => {
        if (!card.classList.contains('hidden')){
          const cat = card.dataset.category || 'References';
          byCategory[cat] = (byCategory[cat] || 0) + 1;
        }
      });
      document.getElementById('countCalculators').textContent = byCategory.Calculators || 0;
      document.getElementById('countGuidelines').textContent = byCategory.Guidelines || 0;
      document.getElementById('countReferences').textContent = byCategory.References || 0;
    }

    q?.addEventListener('input', applyFilter);

    // "/" focuses search, Esc clears
    window.addEventListener('keydown', (e) => {
      if (e.key === '/' && document.activeElement !== q) {
        e.preventDefault();
        q.focus();
      }
      if (e.key === 'Escape' && document.activeElement === q) {
        q.value = '';
        applyFilter();
        q.blur();
      }
    });

    // Footer helpers
    document.getElementById('year').textContent = new Date().getFullYear();
    document.getElementById('clearSearch').addEventListener('click', (e) => {
      e.preventDefault();
      q.value = '';
      applyFilter();
      q.focus();
    });
    document.getElementById('scrollTop').addEventListener('click', (e) => {
      e.preventDefault();
      window.scrollTo({top: 0, behavior: 'smooth'});
    });

    // Initialize counts on load
    updateCounts();
  </script>
</body>
</html>